# Video Menu - Prompt Toolkit Version

## Описание

Новая версия TUI меню для выбора видео с использованием библиотеки **prompt_toolkit**.

### Основные возможности

1. **Навигация по файлам и папкам**
   - Отображение списка директорий и видео файлов
   - Статус просмотра: `[X]` - просмотрено, `[T]` - частично, `[ ]` - не просмотрено
   - Отображение размера файлов

2. **Диалог настроек сериала**
   - Единый интерфейс с чекбоксами и полями ввода
   - **Чекбоксы:**
     - Autoplay (автопродолжение следующей серии)
     - Skip Intro (пропуск начальной заставки)
     - Skip Outro (пропуск конечных титров)
   
   - **Поля ввода времени (MM:SS):**
     - Intro Start - время начала интро
     - Intro End - время окончания интро
     - Outro Duration - длительность титров
   
   - **Особенности ввода:**
     - Режим замены цифр (не вставка)
     - Контрастный цвет (желтый фон + черный текст) для цифры под курсором
     - Валидация: секунды 0-59, минуты без ограничения

3. **Интеграция с БД**
   - Использует `vlc_db.VlcDatabase` для сохранения настроек
   - Автоматическое извлечение series_prefix через `db-manager.sh`

## Установка

### Вариант 1: Использование виртуального окружения (рекомендуется)

```bash
# Создать виртуальное окружение (если не создано)
cd /path/to/vlc
python3 -m venv venv

# Установить зависимости
venv/bin/pip install -r Py/requirements.txt

# Запуск через wrapper скрипт
./Py/run-prompt-toolkit.sh

# Запуск с указанной директории
./Py/run-prompt-toolkit.sh /path/to/videos
```

### Вариант 2: Установка глобально

```bash
# Установить зависимости глобально
pip install prompt_toolkit pythondialog

# Запуск напрямую
./Py/video-menu-Prompt_toolkit.py
```

## Использование

```bash
# Запуск с текущей директории
./Py/video-menu-Prompt_toolkit.py

# Запуск с указанной директории
./Py/video-menu-Prompt_toolkit.py /path/to/videos
```

## Управление

### В главном меню:
- `↑` / `↓` - навигация по списку
- `Enter` - открыть папку / выбрать видео
- `S` - открыть настройки сериала
- `Q` / `Esc` - выход

### В диалоге настроек:
- `↑` / `↓` - перемещение между элементами
- `Space` - переключить чекбокс
- `←` / `→` - перемещение курсора в поле времени
- `0-9` - ввод цифр (режим замены)
- `Enter` - сохранить и выйти
- `Esc` - отменить изменения

## Технические детали

### Класс TimeInput
Кастомный виджет для ввода времени в формате MM:SS:
- 4 позиции курсора (пропускает ':')
- Автоматическая валидация секунд (0-59)
- Визуальная подсветка текущей позиции
- Автоматическое перемещение курсора после ввода

### Стили
- Фон курсора: `bg:#ffff00 #000000 bold` (желтый фон, черный текст)
- Выбранный элемент меню: `bg:#00aa00 #000000 bold` (зеленый фон)
- Время: `#00ff00` (зеленый цвет)
- Чекбоксы: подсветка при фокусе

## Отличия от других версий

| Версия | Библиотека | Диалог настроек |
|--------|-----------|-----------------|
| video-menu-dialog.py | pythondialog + dialog | mixedform (экспериментально) |
| video-menu-whiptail.py | pythondialog + whiptail | 2 шага: чекбоксы → поля ввода |
| **video-menu-Prompt_toolkit.py** | **prompt_toolkit** | **Единый диалог с полным контролем** |

## Преимущества prompt_toolkit

✅ Полный контроль над UI и UX  
✅ Режим замены при вводе  
✅ Кастомная подсветка курсора  
✅ Нет зависимости от внешних утилит (dialog/whiptail)  
✅ Современный, чистый код  
✅ Поддержка Python 3.6+
