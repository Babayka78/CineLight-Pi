# Summary: Skip Intro/Outro + Autoplay Planning

**–î–∞—Ç–∞:** 02.12.2025  
**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~4 —á–∞—Å–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏—è  
**–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –æ–∂–∏–¥–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üéØ –ß—Ç–æ –æ–±—Å—É–¥–∏–ª–∏

### 1. Skip Intro/Outro - –î–µ—Ç–∞–ª–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–µ—Ç–æ–∫ —á–µ—Ä–µ–∑ **RED –∫–Ω–æ–ø–∫—É** –≤–æ –≤—Ä–µ–º—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –º–µ–Ω—é (MM:SS —Ñ–æ—Ä–º–∞—Ç)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–ø—É—Å–∫ –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏

**–õ–æ–≥–∏–∫–∞ RED –∫–Ω–æ–ø–∫–∏:**
- 0-20% –≤–∏–¥–µ–æ: RED 1–π —Ä–∞–∑ = intro_start, RED 2–π —Ä–∞–∑ = intro_end
- 80-100% –≤–∏–¥–µ–æ: RED = outro_start
- 20-80% –≤–∏–¥–µ–æ: RED –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è ‚úÖ

**–í–∞–∂–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:**
- Intro –º–æ–∂–µ—Ç –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å 0 —Å–µ–∫—É–Ω–¥—ã –ò–õ–ò —á–µ—Ä–µ–∑ 2+ –º–∏–Ω—É—Ç—ã
- –£—Å–ª–æ–≤–∏–µ: `if intro_start is not None and intro_start <= time < intro_end`
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫ (–≤–º–µ—Å—Ç–æ 60) –∫–æ–≥–¥–∞ skip –≤–∫–ª—é—á–µ–Ω
- –î–æ–ø—É—Å—Ç–∏–º–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å skip: ¬±2-3 —Å–µ–∫—É–Ω–¥—ã ‚úÖ

---

### 2. Autoplay - –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è

**‚ùå –û–¢–õ–û–ñ–ï–ù–û –Ω–∞ –±—É–¥—É—â–µ–µ:**
- OSD –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–∏—è–º–∏
- Sleep detection —á–µ—Ä–µ–∑ —Ç–∞–π–º–µ—Ä
- –í—Å—ë —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Å–Ω—É–ª"

**‚úÖ –ß–¢–û –†–ï–ê–õ–ò–ó–£–ï–ú –°–ï–ô–ß–ê–°:**

#### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–∞
- –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ autoplay ‚Üí —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–∞–ø–∫—É –û–î–ò–ù –†–ê–ó
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–ø–∏—Å–æ–∫ —ç–ø–∏–∑–æ–¥–æ–≤ –≤ –ë–î (–Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `playlist_cache`)
- –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Ä–∏–∏:
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `file_count` (–±—ã—Å—Ç—Ä—ã–π `ls -1 | wc -l`)
  - –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å ‚Üí –ø–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å
  - –ò–Ω–∞—á–µ ‚Üí –±—Ä–∞—Ç—å –∏–∑ –∫–µ—à–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î:**
```sql
CREATE TABLE playlist_cache (
    series_prefix TEXT,
    series_suffix TEXT,
    directory TEXT,
    episode_count INTEGER,
    episodes TEXT,  -- JSON: ["E01.mkv", "E02.avi", ...]
    last_scan TIMESTAMP,
    PRIMARY KEY (series_prefix, series_suffix, directory)
);
```

#### –ü–æ–∏—Å–∫ —Å–ª–µ–¥—É—é—â–µ–≥–æ —ç–ø–∏–∑–æ–¥–∞
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—è 1:** –ü–æ S##E## –ø–∞—Ç—Ç–µ—Ä–Ω—É (E05 ‚Üí E06)
- **Fallback:** –ï—Å–ª–∏ –Ω–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞ ‚Üí sorted –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
- –°–∫–∞–Ω–∏—Ä—É—é—Ç—Å—è –≤—Å–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è: mkv, avi, mp4, mov, wmv, flv

---

### 3. –ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å [S] - Sleep

**–î–ª—è –±—É–¥—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ autoplay:**
- `[ ]` - –ù–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ
- `[T]` - –ß–∞—Å—Ç–∏—á–Ω–æ (1-94%)
- `[X]` - –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ (95-100%)
- `[S]` - **–ó–∞—Å–Ω—É–ª** (autoplay –ø—Ä–µ—Ä–≤–∞–Ω, –ø–æ–∑–∏—Ü–∏—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞)

**–õ–æ–≥–∏–∫–∞ (–∫–æ–≥–¥–∞ autoplay –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω):**
- –î–æ—Å–º–æ—Ç—Ä–µ–ª E03 –¥–æ outro ‚Üí autoplay –∑–∞–ø—É—Å–∫–∞–µ—Ç E04
- –ù–∞ E04 –Ω–µ –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞–ª (–∑–∞—Å–Ω—É–ª)
- **E03 –ø–æ–º–µ—á–∞–µ—Ç—Å—è [S]** (–Ω–µ [X]!)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º –≤—Å–ø–æ–º–Ω–∏—Ç –≥–¥–µ –∑–∞—Å–Ω—É–ª

**–ë–î –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```sql
ALTER TABLE playback ADD COLUMN status TEXT DEFAULT NULL;
-- –ó–Ω–∞—á–µ–Ω–∏—è: NULL/'active' = [ ], 'watched' = [X], 'partial' = [T], 'sleep' = [S]
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ –≤—ã—á–∏—Å–ª—è—Ç—å –Ω–∞ –ª–µ—Ç—É (–º–µ–¥–ª–µ–Ω–Ω–æ)
- ‚úÖ –Ø–≤–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Å—Ç–∞—Ç—É—Å–∞
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

---

### 4. Sleep Protection - –û–¢–ú–ï–ù–Å–ù

**–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –¥—É–º–∞–ª:** –ó–∞—â–∏—Ç–∞ –æ—Ç device sleep mode (xset, xdotool)
**–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ:** Raspberry Pi –≤ CLI —Ä–µ–∂–∏–º–µ, screensaver –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è ‚úÖ

**–ß—Ç–æ –†–ï–ê–õ–¨–ù–û –Ω—É–∂–Ω–æ:** Sleep Detection = –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Å–Ω—É–ª
‚Üí **–û–¢–õ–û–ñ–ï–ù–û** –Ω–∞ –±—É–¥—É—â–µ–µ, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç autoplay

---

### 5. CEC –∫–Ω–æ–ø–∫–∏ - –ü—Ä–æ–±–ª–µ–º–∞

**–í—ã—è—Å–Ω–µ–Ω–æ:**
- ‚¨ÜÔ∏è UP = +60 —Å–µ–∫
- ‚¨áÔ∏è DOWN = -60 —Å–µ–∫  
- ‚û°Ô∏è RIGHT = +10 —Å–µ–∫
- ‚¨ÖÔ∏è LEFT = -10 —Å–µ–∫
- **–í—Å–µ –∑–∞–Ω—è—Ç—ã –¥–ª—è skip!**

**–î–ª—è OSD (–±—É–¥—É—â–µ–µ):**
- BACK = –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ autoplay
- –ò–ª–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç CEC –≤–æ –≤—Ä–µ–º—è OSD –∞–∫—Ç–∏–≤–Ω–æ–≥–æ

---

### 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

**–û—Ç–∫–∞—Ç –Ω–∞ –º–∏–Ω—É—Ç—É –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ:**
- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω–æ–≥–æ –≤–∏–¥–µ–æ ‚Üí –æ—Ç–∫–∞—Ç–∏—Ç—å –Ω–∞ -60 —Å–µ–∫
- –ß—Ç–æ–±—ã –≤—Å–ø–æ–º–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç

**–ü—Ä–æ—Ü–µ–Ω—Ç —è–≤–Ω–æ –≤ –ë–î:**
- –ù–µ –≤—ã—á–∏—Å–ª—è—Ç—å `position * 100 / duration` –∫–∞–∂–¥—ã–π —Ä–∞–∑
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ø–æ–ª–µ `percent` —Å—Ä–∞–∑—É

**–í–Ω–µ—à–Ω–∏–µ –∞—É–¥–∏–æ–¥–æ—Ä–æ–∂–∫–∏:**
- –ë—É–¥—É—â–∞—è —Ñ–∏—á–∞ (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- –ó–∞–ø–∏—Å–∞–Ω–æ –≤ `DOCS/future_features/`

---

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –°–µ–π—á–∞—Å (–ø–æ—Å–ª–µ fix –±–∞–≥–∞ —Å—Ç–∞—Ç—É—Å–æ–≤):
1. **–ë–î –ø–æ–ª–µ `status`** - –¥–ª—è [S] —Å—Ç–∞—Ç—É—Å–∞
2. **–ö–µ—à –ø–ª–µ–π–ª–∏—Å—Ç–∞ –≤ –ë–î** - playlist_cache —Ç–∞–±–ª–∏—Ü–∞
3. **–§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ —ç–ø–∏–∑–æ–¥–∞** - –ø–æ S##E## + fallback
4. **–û—Ç–∫–∞—Ç –Ω–∞ –º–∏–Ω—É—Ç—É** - –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É

### –ü–æ–∑–∂–µ:
1. Skip Intro/Outro (–±–∞–∑–æ–≤—ã–π)
2. RED –∫–Ω–æ–ø–∫–∞ –¥–ª—è –º–µ—Ç–æ–∫
3. UI —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–∫

### –û—Ç–ª–æ–∂–µ–Ω–æ:
1. Autoplay —Å OSD
2. Sleep Detection
3. –í–Ω–µ—à–Ω–∏–µ –∞—É–¥–∏–æ–¥–æ—Ä–æ–∂–∫–∏

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏

**–ë–∞–≥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ (v0.4.0):**
- –°—Ç–∞—Ç—É—Å—ã [X] [T] [ ] –ù–ï –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –º–µ–Ω—é
- –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –Ω–æ –∏–∫–æ–Ω–∫–∏ –Ω–µ –≤–∏–¥–Ω—ã
- –¢—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–∫–∞—Ç –∫ –≤–µ—Ä—Å–∏–∏ –î–û –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–µ—à–∞
- –ë–∞–≥ –≤ `playback-tracker.sh` - –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–π –º–∞—Å—Å–∏–≤

**–¢–æ–∫–µ–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ:** ~115k / 200k (58%)

---

## ‚úÖ –ò—Ç–æ–≥–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–æ–∫—É–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã:**
- `implementation_plan.md` - –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω
- `clarifications.md` - —É—Ç–æ—á–Ω–µ–Ω–∏—è –ø–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º
- `final_decisions.md` - —É—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- `critical_issues.md` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:**
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å –ø–ª–µ–π–ª–∏—Å—Ç –≤ –ë–î
- ‚úÖ –°—Ç–∞—Ç—É—Å [S] –¥–ª—è "–∑–∞—Å–Ω—É–ª"
- ‚úÖ –û—Ç–∫–∞—Ç –Ω–∞ –º–∏–Ω—É—Ç—É –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —è–≤–Ω–æ –≤ –ë–î
- ‚ùå Sleep detection - –æ—Ç–ª–æ–∂–µ–Ω
- ‚ùå OSD autoplay - –æ—Ç–ª–æ–∂–µ–Ω

**–ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ:**
1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
3. –†–µ–ª–∏–∑–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏

---

**–°–ª–µ–¥—É—é—â–∞—è —Å–µ—Å—Å–∏—è:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ ‚Üí —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—É–Ω–∫—Ç—ã –∏–∑ "–°–µ–π—á–∞—Å"
